# Oracle WebCenter Interaction - Hardcoded Search Service Password

**CVE:** CVE-2018-16957

**CVSSv3:** 5.9 - CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N

**Versions affected:** queryd.exe 10.3.3.379250

## Introduction

Oracle WebCenter Interaction, formerly called BEA AquaLogic User Interaction and now part of Oracle WebCenter Suite, is an integrated, comprehensive collection of components used to create enterprise portals, collaborative communities, and composite and social applications.

## Background

Oracle WCI provides a search service that enables the portal and other components to perform efficient searches for data throughout the platform. The search service runs as a Windows network service that executes the `queryd.exe` binary.

`queryd` is binary application written in C++ (VC2008).

## Vulnerability

The Oracle WCI search service requires authentication before a query can be issued and returned. This prevents unauthenticated users from accessing sensitive data stored within the product suite.

However, the search service uses a static password that has been hardcoded in the search service binary: `queryd.exe`.

The `checkPassword()` password function within the `QueryParser` class validates the login sent by a client of the search service. The validation is performed against a static string; indicating the password is both static and hardcoded in every copy of the software (shown in Figure 1 below).

![hardcoded password](images/05-comparedpassword-function.jpg)

The hardcoded password is as follows: `i1g2s3c4`

An attacker with access to the search service over the network (port 15250) can gain unauthorised access to all data by performing search queries with the hardcoded password. The use of a static password defeats the purpose of the authentication system.

## Versions Affected

This vulnerability affects build 10.3.3.379250 of the Oracle WCI search service (queryd.exe).

## References

N/A

## Credit

This vulnerability was discovered by Ben N (pajexali@gmail.com) 26 June 2018.

---
mainfont: Roboto
monofont: Source Code Pro
header-includes:
    - \lstset{breaklines=true}
    - \lstset{language=[Motorola68k]Assembler}
    - \lstset{basicstyle=\small\ttfamily}
    - \lstset{extendedchars=true}
    - \lstset{tabsize=2}
    - \lstset{columns=fixed}
    - \lstset{showstringspaces=false}
    - \lstset{frame=trbl}
    - \lstset{frameround=tttt}
    - \lstset{framesep=4pt}
    - \lstset{numbers=left}
    - \lstset{numberstyle=\tiny\ttfamily}
    - \lstset{postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}}
...
