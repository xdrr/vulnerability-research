# Oracle WebCenter Interaction - Weak Cookie Configuration

**CVE:** CVE-2018-16958

**CVSSv3:** 5.4 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N

**Versions affected:** 10.3.3

## Introduction

Oracle WebCenter Interaction, formerly called BEA AquaLogic User Interaction and now part of Oracle WebCenter Suite, is an integrated, comprehensive collection of components used to create enterprise portals, collaborative communities, and composite and social applications.

## Background

The Oracle WebCenter Interaction (WCI) portal provides the primary user interface to the suite of products included in WCI. The portal can be deployed as an ASP.NET application for IIS when installed on Windows Server.

## Vulnerability

The WCI portal makes use of the primary session cookie in JavaScript. It is believed that for this reason, the `httpOnly` attribute is explicitly removed from the session cookie when set. The attribute can not be set using the `Web.config` configuration file as the application code prevents this.

Forcefully disabling this cookie attribute exposes the session cookie directly to cross-site scripting (XSS) vulnerabilities (such as CVE-2018-16953 and CVE-2018-16955). This exposure allows an attacker to hijack user sessions.

Further investigation of the rationale behind disabling this attribute revealed that the only use of `document.cookie` in the application appears in the `doLogin` JS function on the login page. It sets the `ASP.NET_SessionId cookie` to blank before login. This function is shown below.

```javascript
function doLogin()
{
    var persistInfo = true;
    var cb = getRememberCheckbox();
    if (!persistInfo || !cb || !cb.checked)
    {
        deleteLoginInfo();
    }
    else
    {
        var authSource = 0;
        var sel = getAutoSourceSelect();
        if (sel) { authSource = sel.selectedIndex; }
        storeLoginInfo(authSource);
    }
    var loginForm = document.lform;
    var hiddenLogin = loginForm.in_hi_dologin;
    hiddenLogin.value = 'true';
    document.cookie= "ASP.NET_SessionId=; path=/; expires=Thu, 01-Jan-1970 00:00:01 GMT" 
    loginForm.submit();
}
```

However, the default behaviour of the ASP.NET site is to replace the cookie set during login, hence there's no reason to clear the cookie in JavaScript.

## Versions Affected

This vulnerability affects version 10.3.3 of the Oracle WebCenter Interaction portal - specifically build 10.3.3.379633 (the latest version at the time of writing).

## References

N/A

## Credit

This vulnerability was discovered by Ben N (pajexali@gmail.com) 26 June 2018.

---
mainfont: Roboto
monofont: Source Code Pro
header-includes:
    - \lstset{breaklines=true}
    - \lstset{language=[Motorola68k]Assembler}
    - \lstset{basicstyle=\small\ttfamily}
    - \lstset{extendedchars=true}
    - \lstset{tabsize=2}
    - \lstset{columns=fixed}
    - \lstset{showstringspaces=false}
    - \lstset{frame=trbl}
    - \lstset{frameround=tttt}
    - \lstset{framesep=4pt}
    - \lstset{numbers=left}
    - \lstset{numberstyle=\tiny\ttfamily}
    - \lstset{postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}}
...